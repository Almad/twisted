#!/usr/bin/env python

"""
Usage: mkserver <servertype> <server_options>
       mkserver --help
       mkserver --help <servertype>

"""

### Twisted Preamble
# This makes sure that users don't have to set up their environment
# specially in order to run these programs from bin/.
import sys,os,string

if string.find(os.path.abspath(sys.argv[0]),'Twisted') != -1:
    sys.path.append(os.path.dirname(
        os.path.dirname(os.path.abspath(sys.argv[0])))) 
### end of preamble

from twisted.protocols import telnet
from twisted.internet import main,tcp
from twisted.python import usage
import sys, traceback

try:
    command = sys.argv[1]
except:
    print __doc__
    sys.exit()

try:
    mod = __import__("twisted.util.mk%sserver" % command, globals(), locals(), command)
except ImportError:
    traceback.print_exc()
    print "Please select one of 'telnet', 'irc', 'reality', 'web', 'toc'."
    sys.exit()

try:
    config = mod.Options()
    config.parseOptions(sys.argv[2:])
except usage.error, ue:
    print mod.usage_message
    print "Usage Error: %s" % ue
    sys.exit()

a = main.Application(command)
for x in mod.getPorts(a, config):
    a.addPort(x)
a.save()

