<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>The Basics</title>
</head>

<body>
<h1>The basics</h1>

<h2>Application</h2>

<p>Twisted programs usually work with
<code class="API">twisted.internet.app.Application</code>.
This class usuallly holds all persistent configuration of
a running server -- ports to bind to, places where connections
to must be kept or attempted, periodic actions to do and most
everything else.</p>

<p>Other HOWTOs teach how to write custom code for Applications,
but here it will be taught how to use code already written (either
by the Twisted developers or by third-party Twisted plugin developers.
The Twisted distribution comes with an assortment of tools to create
and manipulate <code>Application</code>s.</p>

<p><code>Application</code>s are just Python objects, which can
be created and manipulated in the same ways as any other object.
In particular, they can be serialized to files. Twisted supports
several serialization formats.</p>

<h2>Serialization</h2>

<dl>

<dt>TAP</dt>
<dd>A Twisted Application Pickle. This format is supported by the
    native Python pickle support. While not being human readable,
    this format is the fastest to load and save.</dd>

<dt>TAX</dt>
<dd>Twisted contains the
    <code class="API">twisted.persisted.marmalade</code> module
    supports serializing and deserializing from a fortmat which follows
    the XML standard. This format is human readable and editable.</dd>

<dt>TAS</dt>
<dd>Twisted contains the
    <code class="API">twisted.persisted.aot</code> module
    supports serializing into Python source. This has the advantage
    of using Python's own parser and being able to later manually
    add Python code to the file.</dd>

</dl>

<h2>mktap and tapconvert</h2>

<p>The <code>mktap(1)</code> utility is the main way to create file.
It can be used to create an Application for all of the major Twisted
server types like web, ftp or IRC. It also supports plugins, so when
you install a Twisted plugin (that is, unpack it into a directory on
your <code>PYTHONPATH</code>) it will automatically detect it and use
any Twisted Application support in it. It can create any of the above
Application formats.</p>

<p>In order to see which server types are available, use 
<code>mktap --help</code>. For a given server, 
<code>mktap --help &lt;name&gt;</code> shows the possible configuration
options. <code>mktap</code> supports a number of generic options
to configure the application -- for full details, read the man page.</p>

<p>One important option is <code>--append &lt;filename&gt;</code>.
This is used when there is already a Twisted application serialized
to which a server should be added. For example, it can be used
to add a telnet server, which would let you probe and reconfigure
the application by telnetting into it.</p>

<p>Another useful utility is <code>tapconvert(1)</code>, which converts
between all three Application formats.</p>

<h2>twistd</h2>

<p>Having <code>Application</code> in a variety of format, aesthetically
pleasing as it may be, does not actually cause anything to happen.
For that, we need a program which takes a "dead" Application and brings
life to it. For UNIX systems (and, until there are are alternatives,
for other operating systems too), this program is <code>twistd(1)</code>.
Strictly speaking, <code>twistd</code> is not necessary -- unserializing
the application and calling its <code>.run</code> method could be
done manually. <code>twistd(1)</code>, however, supplies many options
which are highly useful for program set up.</p>

<p><code>twistd</code> supports choosing a reactor (for more on
reactors, see <a href="choosing-reactor.html">choosing reactor</a>), logging
to a logfile, daemonizing and more. <code>twistd</code> supports all
Applications mentioned above -- and an additional one. Sometimes
is is convenient to write the code for building a class in straight
Python. One big source of such Python files is the <code>doc/examples</code>
directory. When a straight Python file which defines an <code>Application</code>
object called <code>application</code> is used, use the <code>-y</code>
option.</p>

<p>When <code>twistd</code> runs, it records its process id in a
<code>twistd.pid</code> file (this can be configured via a command line
switch). In order to shutdown the <code>twistd</code> process, kill that
pid. When the process is killed in an orderly fashion it will leave behind
the "shutdown Application" which is named the same as the original file
as a <code>-shutdown</code> added to its base name. This contains the
new configuration information, as changed in the application.</p>

<p>As always, the gory details are in the manual page.</p>

</body></html>
