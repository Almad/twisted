<html>
<head>
<title>Releasing Twisted</title>
</head>
<body>
<h1>Releasing Twisted</h1>

<h2>Pre-release</h2>

<h3>Test</h3>


<ul>
  <li>
  <p>run the unit tests.</p>
  <pre class="shell">./admin/runtests</pre>
  </li>

  <li><p>run the accepttests. It's important that you run the accepttests with a non-relative command line (stupid bug that still isn't fixed. Too easy to work around :)). I use:</p>
  <pre class="shell">WEBBROWSER='galeon -n' IRCCLIENT=epic4 ~/Projects/Twisted/admin/accepttests -b</pre>
  </li>

  <li>kill your regular personal server on pyramid, if you have one.</li>

  <li><p> run the pre-release tests, on pyramid. When `less' comes up, <em>check for errors</em>.</p>
  <pre class="shell">./admin/prereleasetests</pre>
  </li>

  <li>Restart your personal server. :-)</li>

</ul>


<h3>Documentation</h3>

<ul>
  <li>ChangeLog.
  <ul>
    <li>Browse through twisted-commits; if you see any updates that are
    significant but weren't mentioned in ChangeLog, retroactively add them</li>
    <li>Add an entry: * .: Releasing Twisted $VERSION</li>
  </ul>
  </li>
  <li>README: Add a new Quote of the Release.</li>
</ul>

<h2>Release</h2>

<h3>win32</h3>
<p>Run win32/bdist_wininst.bat.</p>

<h3>Unix</h3>

<ul>
  <li>
  <p>
  If you are working from a CVS version of Twisted which you want to release,
  make sure it is named "Twisted.CVS", and in the directory immediately
  above it there is nothing else (that can be done via symlinks), and run:
  </p>
  <pre class="shell">./Twisted.CVS/admin/release-twisted -V $VERSION -o $LASTVERSION --release=/twisted/Releases --upver --tag --exp --dist --docs --balls --rel --deb --debi</pre>
  </li>
  
  <li>
  <p>
  If you want to release the latest CVS version of Twisted, have a
  reasonably recent checkout of Twisted in $SOMEWHERE, and in an empty directory
  do
  </p>
  <pre class="shell">$SOMEWHERE/admin/release-twisted -V $VERSION -o $LASTVERSION --checkout --release=/twisted/Releases --upver --tag --exp --dist --docs --balls --rel --deb --debi</pre>
  </li>
</ul>


<h2>Post-release</h2>

<h3>Upgrade pyramid</h3>

<ul>
  <li>
  <p>Restart the main Twisted web server:</p>
<pre class="shell">sudo /etc/init.d/twisted-web stop
sudo /etc/init.d/twisted-web start
</pre>
  </li>

  <li>
  <p>If necessary (only when distributed web changes protocols; this is very rare any more), restart snibril's server.</p>
  <pre class="shell">su jh; ~jh/bin/stop; ~jh/bin/start; exit</pre>
  </li>

</ul>

<h3>Distribute</h3>
<p>Upload to Sourceforge</p>
<pre class="shell">$SOMEWHERE/admin/release-twisted -n $SFNAME -v $VERSION --sourceforge --release=/twisted/Releases</pre>

<h3>Update Website</h3>

<ul>
  <li>If everything's cool, edit WebSite/twistedmatrix.com/news.html, index, products/get-current.epy and products/download.html</li>
  <li>cvs commit those</li>
  <li><p>deploy changes:</p>
<pre class="shell">cd /var/www/WebSite/twistedmatrix.com
lore --docsdir . --config template=template.tpl --config ext=
</pre>
  </li>
</ul>

<h3>Announcements</h3>

<ul>
  <li>Freshmeat</li>
  <li>comp.lang.python</li>
  <li>comp.lang.python.announce</li>
  <li>parnassus</li>
</ul>

<h3>Notify Packagers</h3>
<ul>
  <li>Debian: Moshe Zadka <a href="mailto:moshez (at) twistedmatrix (dot) com">moshez (at) twistedmatrix (dot) com</a></li>
  <li>FreeBSD: Johann Visagie <a href="mailto:wjv (at) freebsd (dot) org">wjv (at) freebsd (dot) org</a></li>
  <li>Win32: MoonFallen</li>
  <li>Gentoo: <a href="mailto:lordvan (at) gentoo (dot) org">lordvan (at) gentoo (dot) org</a></li>
</ul>



</body>
</html>

